<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>countdown</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="assets/style.css">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,500,700" rel="stylesheet">
    <link rel="icon" href="countdown-logo.png">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D95N5N9LWR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-D95N5N9LWR');
    </script>
  </head>
  <body>
    <p class="enddate" id="endDate"></p>
    <h1 class="center">Time until school ends:</h1>
    <h4 class="center">Including weekends and breaks
    <p id="countdown" class="Countdowntimer"></p>
    <p class="top-right" id="currentDateTime"></p> 
    <script>
        // Countdown Timer Script
        var endDay = new Date("May 31, 2024")
        var countDownDate = new Date("May 31, 2024 15:34:59").getTime();
      
        var x = setInterval(function() {
        var now = new Date().getTime();
        var distance = countDownDate - now;

        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);
        // exclude weekends ..
        var numWorkingDays = 0; // count of M,T,W,T,F days 
        var today = new Date(); // start date for the loop
        for (var x = 0; x <= days; x++) {
          // get the next day's date ...
          var nextDay = new Date();
          nextDay.setDate(today.getDate() + x);
          // getDay() returns weekday in numbers. 0 = Sunday, 6 = Saturday.
          if (nextDay.getDay() == 0 || nextDay.getDay() == 6) {
            // do nothing.
            // console.info("Is a weekend: ", nextDay.getDate());
          } else {
            // is a M,T,W,T,F .. increment numWorkingDays by 1.
            // console.info("Not a weekend: ", nextDay.getDate());
            numWorkingDays++;
          }
        }
        // unused var numWorkingDays for excluding weekends
        document.getElementById("countdown").innerHTML = days + "d " + hours + "h " + minutes + "m " + seconds + "s ";
        document.getElementById("currentDateTime").innerHTML = today.toLocaleTimeString() + " | " + today.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById("endDate").innerHTML = "Last day: " + endDay.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }); 
        if (distance < 0) {
          clearInterval(x);
          document.getElementById("countdown").innerHTML = "Its over";
        }
      }, 1000);

      // Function to update the content of the countdown element with the current date
      function updateCurrentDateTime() {
        var currentDate = new Date();
      
        // Format the date and time
        var formattedDateTime = currentDate.toLocaleTimeString() + " | " + currentDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById('currentDateTime').textContent = formattedDateTime;
      }
      // Call the function to update the current date and time initially
      updateCurrentDateTime();
      
      setInterval(updateCurrentDateTime, 1000);
    </script>
  </body>
  <footer class="footer">
    <p>v5.1</p>
    <p><a href='https://github.com/drewl1/drewl1.github.io' class='footer'>source code</a></p>
  </footer>
</html>
